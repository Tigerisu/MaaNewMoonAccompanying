# 问题排查

## 问题自检

如果您在使用 MNMA 时遇到了问题，请先按如下步骤进行自检：

1. 确保**模拟器使用 mumu12**，模拟器**设置开启本地 ADB**，**分辨率比例为 16:9**
2. 确保电脑**没有启用火绒或电脑管家**等防火墙，或已将 MNMA 添加至所有杀毒软件的信任文件中
3. 确保没有其他游戏脚本类软件在操作运行新月的模拟器
4. **确保 MNMA 为最新版本，或尝试重装最新版 MNMA**
5. 尝试**右键并使用管理员权限**打开 MNMA
6. 关闭 MNMA、模拟器后，在任务管理器中强制结束 `adb.exe` 运行，然后重新尝试。
7. **重启电脑可以解决 99%的问题！**

若以上操作后问题仍未解决，请继续阅读。

## 反馈问题

如果本节后续收录内容没有解决您的问题，您可以在 Github 提交 [issue](https://github.com/kqcoxn/MaaNewMoonAccompanying/issues?q=is%3Aissue)，或在 [QQ 群](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=VMC132QhbMDLi5U62MlDRvtCMj9WOXRr&authKey=yJNKO4sQ%2BBFHpBCLSSEvVOAyz%2FPjknNSl70W3ugg2%2BpELnKmEiHamj1emJMWcLwQ&noverify=0&group_code=993245868) 内礼貌请教群友，但**请确保已经查看过手册对应部分的说明**。

::: tip
本节会持续收录各位组长遇到的问题，所以**您的反馈将会有助于其他组长解决问题**！

在回答其他群友问题时，您可以直接引用本页面连接，方便群友查看。
:::

若是群友没法解决您的问题，您需要做以下准备：

1. 在可能的情况下，复现问题情况，并截图或录制视频
2. 运行 MNMA 根目录下 `反馈打包小工具.exe`
3. 将打包好的 `反馈日志.zip` 同视频与截图发送至群内，并描述问题情况
4. 若群友无法帮忙解决，在群内@群主或私聊群主

## 远程协助

若您需要远程协助，请按如下方式进行准备：

1. 下载并安装 [ToDesk](https://www.todesk.com/) 远程控制软件普通版（若您在国外请直接邀请 QQ 远程）
2. **关闭您电脑不希望被看到的程序或文件**
3. 打开 MNMA 文件夹根目录与模拟器，若在游戏内可以先完成当前事情
4. 准备好被远控后，将 ToDesk 设备码与临时密码**复制粘贴文字**并**私聊**发送，等待连接

![图片加载中，请稍等...](/users/remote.png)

## 下载安装类

### Github 页面打不开/下载缓慢

国内对于 Github 的防火墙时有时无，且速度非常不稳定。如果条件允许，请使用网络代理或加速器访问。

如果您无法通过其他途径进入 Github 页面，或下载速度被限制，可以在 [QQ 群](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=VMC132QhbMDLi5U62MlDRvtCMj9WOXRr&authKey=yJNKO4sQ%2BBFHpBCLSSEvVOAyz%2FPjknNSl70W3ugg2%2BpELnKmEiHamj1emJMWcLwQ&noverify=0&group_code=993245868) **群文件**内获取您需要的资源，包括 MNMA 压缩包、更新包等。

或者，您可以使用 [Mirror 酱](./install.md#mirror-酱支持可选) 作为国内镜像源下载。（需要自备 CDK）

### 更新失败/速度缓慢

若您的下载源为 Github，国内对于 Github 的防火墙时有时无，且速度非常不稳定。如果条件允许，请在网络代理或加速器环境下更新。

或者，您可以在设置页面切换 [Mirror 酱](./install.md#mirror-酱支持可选) 作为国内镜像源更新。（需要自备 CDK）

如果您不希望通过其他途径更新，您可以在[QQ 群](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=VMC132QhbMDLi5U62MlDRvtCMj9WOXRr&authKey=yJNKO4sQ%2BBFHpBCLSSEvVOAyz%2FPjknNSl70W3ugg2%2BpELnKmEiHamj1emJMWcLwQ&noverify=0&group_code=993245868) **群文件**内下载最新版本的 MNMA 压缩包覆盖安装。

::: details 为什么不选择国内的更新源？
Github 源免费，而国内常见的下载平台需要用户或开发者付费。

由于开发组经费有限，无力单独承担自建更新服务器成本，因此 MNMA 仅选用 Github 作为通用更新源，选用游戏集成度更高、用户负担更低的 Mirror 酱作为高速付费源。
:::

### 获取最新版本信息失败

若描述为 CDK 无效，请在设置内将下载源调整为 Github，或关闭自动检查/更新。

也可以输入 Mirror 酱 CDK，详情请参考 [Mirror 酱支持](./install.md#mirror-酱支持可选)

## 程序运行类

### SSL Error

大多数情况下并不影响正常使用，关闭弹窗即可，若不希望再次弹出可以关闭代理/梯子。

::: tip
此问题并非由于 MNMA 或 MFAA 导致，出现了此提示代表您可能使用了未配置安全凭证的梯子，或代理通道/凭证识别异常。
:::

### 无法连接至模拟器

请先确保您的模拟器正常启动，得先开着模拟器才能连接到模拟器。

如果模拟器已经启动，请检查模拟器是否已经开启本地 ADB：

![图片加载中，请稍等...](/users/adb.png)

如果您的模拟器没有此选项，请在 mumu12 官网重新下载最新版模拟器。

若已开启此选项，下述任一问题都会并发引起模拟器连接失败问题，请检查是否有相关提示并按相关方案解决。

### 连接模拟器时发生错误

此问题常见于刚更新 mumu 后。

![图片加载中，请稍等...](/users/edit_adb.png)

点击 MNMA 右上角的编辑 ADB 图标，检查额外参数中 `index` 的值，是否大于或等于 0：

![图片加载中，请稍等...](/users/adb_index.png)

若为负数则不正常，需要按如下操作更正：

- 若未开启 mumu 多开功能（仅有一个安卓设备），直接将 `index` 改为 `0`，保存后重启 MNMA 即可。
- 若有多开，则应改成新月模拟器的编号，编号为设备左上角 `#` 后的值

![图片加载中，请稍等...](/users/mumu_index.png)

> 感谢发现并分享此方法的群友 `NOWorEVER` 

### 资源加载失败

若报错中含有“资源加载失败”并伴随“模拟器连接失败”，则可能由于更新时文件被占用导致。

- 若您使用 Mirror 酱或 Github 在软件内更新，请在设置面板点击“重新下载资源全量包”。
- 若为手动更新后导致，**您可能在 v3.0.2 版本前手动更新时进行过覆盖操作，此特性在此版本之后才被支持**，请直接重新安装或使用上一条方案

![图片加载中，请稍等...](/users/reload.png)

### 缺少.dll/运行库、update.NET

MNMA 的运行需要 `VCRedist x64` (`Cli` 与 `Gui` 都需要) 与 `.NET 10` (使用 `GUI` 时需要)依赖环境。

**MNMA 根目录提供了环境的一键安装包，打开 MNMA 根目录，右键后使用管理员方式打开`DependencySetup_依赖库安装_win.bat` 文件即可。**

若打开后闪退，可以在 [QQ 群](http://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=VMC132QhbMDLi5U62MlDRvtCMj9WOXRr&authKey=yJNKO4sQ%2BBFHpBCLSSEvVOAyz%2FPjknNSl70W3ugg2%2BpELnKmEiHamj1emJMWcLwQ&noverify=0&group_code=993245868) **群文件**内下载相关依赖，存储在 `2.环境依赖` 文件夹中。

在安装时，保持默认配置依次点下一步即可，建议不要随意更改环境运行库的安装路径。

### 程序瞬间闪退或无法运行

先尝试重新安装上述依赖，并确保自身系统满足[运行要求](./install.md#下载前须知)

检查您的 MNMA 是否存在如下情况：

- MNMA 所有文件应该在一个独立的文件夹中，而不是解压在磁盘根目录或与其他软件/多个文件夹共用一个目录
- MNMA 目录路径不应该包含中文，如创建文件夹时的“新建文件夹”

若仍无法使用，请进群请求全程协助。

### Agent 加载失败

#### 日志模块报错

Python 包的默认下载源是国内，如果您配置了代理或加速器，可能是由于被拦截导致的，请关闭 MNMA 后关闭代理或加速器，再重新启动 MNMA 尝试。

#### 无任何日志提示

您可能使用了 `XOS` 等定制系统，此类系统缺少 MNMA 运行所需环境，请使用官方系统运行 MNMA。

如果仍然无法解决，请进群询问。

### 目标计算机积极拒绝

若非上述几种，可以尝试在重启后使用管理员权限打开 MNMA

若仍然弹出，情况很多，在群里问吧（
